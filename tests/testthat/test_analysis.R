
test_analysis("Test meta analysis function with sample data", {
  a <- meta_analysis(c(.18, .0, .08, .15, .27, .1, .28, .17, .02, .28),
                     c(426, 328, 122, 284, 472, 154, 372, 674, 110, 116),
                     c(.85, .77, .80, .86, .80, .79, .91, .85, .92, .85),
                     c(.63, .63, .62, .39, .24, .85, .89, .48, .68, .84),
                     c(0.95, 0.80)
  )
  expect_equal(a[1], 10)
  expect_equal(a[2], 3058)
  expect_equal(a[3], 0.171779)
  expect_equal(a[4], 0.0080014)
  expect_equal(a[5], 0.0894506)
  expect_equal(a[6], 0.0282867)
  expect_equal(a[7], 0.00309007449600788)
  expect_equal(a[8], 0.00491133534541514)
  expect_equal(a[9], 0.070080919981227)
  expect_equal(a[10], 0.386191253447696)
  expect_equal(a[11], 0.13732551316772)
  expect_equal(a[12], 0.206232389252162)
  expect_equal(a[13], 0.0819666384931938)
  expect_equal(a[14], 0.261591263926689)
  expect_equal(a[15], 0.240438023443849)
  expect_equal(a[16], 0.02048827427314)
  expect_equal(a[17], 0.00646006515927732)
  expect_equal(a[18], 0.0140282091138627)
  expect_equal(a[19], 0.118440740937663)
  expect_equal(a[20], 0.143137256761264)
  expect_equal(a[21], 0.045263974939393)
  expect_equal(a[22], 0.151722262765515)
  expect_equal(a[23], 0.329153784122183)
  expect_equal(a[24], 0.0886501064709239)
  expect_equal(a[25], 0.392225940416774)
  expect_equal(a[26], 0.245133125580572)
  expect_equal(a[27], 0.240338304613048)
  expect_equal(a[28], 0.0261269323689201)
  expect_equal(a[29], 0.193925279110975)
  expect_equal(a[30], 0.29634097205017)
  expect_equal(a[31], 0.191530316078897)
  expect_equal(a[32], 0.287960542648477)
  expect_equal(a[33], 31.6461943859735)
  expect_equal(a[34], 9)
  expect_equal(a[35], 0.715605614683671)
  expect_equal(a[35], 0.017844999331355)
  expect_equal(a[36], 0.236668909850661)
  expect_equal(a[37], 0.232346937349945)
  expect_equal(a[38], 0.0514298052107599)
  expect_equal(a[39], 0.135868343905661)
  expect_equal(a[40], 0.33746947579566)
  expect_equal(a[41], 0.135038419022624)
  expect_equal(a[42], 0.325216378820423)
  expect_equal(a[43], 188.5554)
})
